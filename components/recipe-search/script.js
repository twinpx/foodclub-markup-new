function onloadRecipeSearchImage(a){function b(){a.style.display="inline-block"}function c(){var b={width:50,height:50},c=new Image;c.src=a.getAttribute("src");var d=c.width,e=c.height;if(d>e){d=d*b.height/e,e=b.height;var f=-1*Math.round((d-b.width)/2);a.style.marginLeft=f+"px"}else if(e>d){e=e*b.width/d,d=b.width;var g=-1*Math.round((e-b.height)/2);a.style.marginTop=g+"px"}else d=b.width,e=b.height;a.setAttribute("width",Math.round(d)),a.setAttribute("height",Math.round(e))}c(),b()}!function(a){"use strict";a(function(){function b(b){function c(){d(),e(),f(),g(),j()}function d(){n.options=b||{},n.options.itemsNum=n.options.itemsNum||{recipes:5,dishes:3,ingredients:3,cuisines:3},n.options.blockTitles=n.options.blockTitles||["recipes","dishes","ingredients","cuisines"],n.options.itemClass=n.options.itemClass||"b-rs__item",n.options.linkClass=n.options.linkClass||"b-rs__item__link",n.options.headingClass=n.options.headingClass||"b-rs__heading",n.options.strClass=n.options.strClass||"b-rs-str",n.options.searchAllClass=n.options.searchAllClass||"b-rs__search-all",n.options.itemTag=n.options.itemTag||"li",n.options.searchDelay=300}function e(){n.$elem=a("#recipeSearch"),n.$input=n.$elem.find(".b-recipe-search__input"),n.$activeItem=n.$input,n.elemValue=a.trim(n.$input.val()),n.$delete=n.$elem.find(".b-recipe-search__delete"),n.$button=n.$elem.find(".b-recipe-search__button"),n.$icon=n.$elem.find(".b-recipe-search__icon")}function f(){n.$list=a('<ul class="b-recipe-search__ul"></ul>'),a("body").hasClass("i-mobile-search")?a("body").append(a('<div id="recipe_search_list"></div>').append(n.$list)):n.$input.parent().append(a('<div id="recipe_search_list"></div>').append(n.$list))}function g(){function b(){n.$elem.toggleClass("i-open").removeClass("i-preloader"),n.$elem.hasClass("i-open")&&n.$input.focus()}function c(){n.$list.hide(),n.$elem.removeClass("i-open").removeClass("i-preloader")}function d(a){a.stopPropagation()}function e(a){return n.elemValue&&(window.location.href=n.$activeItem.is("."+n.options.itemClass)?n.$activeItem.find("."+n.options.linkClass).attr("href"):n.$elem.find("form").attr("action")+n.elemValue+"/"),a.preventDefault(),!1}function f(){return n.elemValue="",n.$input.val(n.elemValue).focus(),i(),j(),!1}function g(a){if(a.ctrlKey)return!1;switch(a.which){case 38:return!1;case 40:return!1}}function l(a){switch(a.which){case 38:o();break;case 40:p();break;case 13:m();break;default:j(),h(),k()}}function m(){n.$button.click()}function o(){n.$activeItem.is(n.$input)?n.$activeItem=n.$list.find(n.options.itemTag+":last"):(s(),n.$activeItem=n.$activeItem.prev(n.options.itemTag)),q(o)}function p(){n.$activeItem.is(n.$input)?n.$activeItem=n.$list.find(n.options.itemTag+":first"):(s(),n.$activeItem=n.$activeItem.next(n.options.itemTag)),q(p)}function q(a){if(!n.$activeItem.is(n.options.itemTag))return n.$activeItem=n.$input,void n.$input.val(n.elemValue);if(n.$activeItem.is("."+n.options.searchAllClass))return n.$input.val(n.elemValue),void r();if(n.$activeItem.is("."+n.options.headingClass))return void a();var b=n.$activeItem.find("."+n.options.strClass).text();n.$input.val(b),r()}function r(a){a=a||n.$activeItem,a.addClass("i-hover")}function s(a){a=a||n.$activeItem,a.removeClass("i-hover")}function t(){function b(){window.foodclubJSON||a.ajax({url:"/php/foodclubJSON.json",type:"GET",dataType:"json",error:ajaxError,success:function(b){window.foodclubJSON=b instanceof String?a.parseJSON(b):b,c()}})}function c(){function a(c){if("object"==typeof c)for(var d in c)c[d]&&c[d].title&&b(c[d]),("object"==typeof c[d]||c[d]instanceof Array)&&a(c[d]);else if(c instanceof Array)for(var e=0;e<c.length;e++)a(c[e])}function b(a){a.lowerTitle=a.title.toLowerCase().replace("ё","е").replace("й","и")}a(foodclubJSON)}b()}n.$input.focus(t).keydown(g).keyup(l),a(document).bind("click",c),n.$list.click(d),n.$delete.click(f),n.$button.click(e),n.$icon.click(b),n.$elem.click(function(a){a.stopPropagation()})}function h(){var a=n.$input.val(),b=/^[-a-zA-Z\u0400-\u04ff0-9\.,\s]*$/;b.test(a)||(n.$input.val(a.slice(0,-1)),h())}function i(){n.$list.empty().hide()}function j(){""===a.trim(n.$input.val())?n.$delete.hide():n.$delete.show()}function k(){n.searchTimeoutId&&clearTimeout(n.searchTimeoutId),n.$elem.addClass("i-preloader"),n.searchTimeoutId=setTimeout(function(){l(),n.$elem.removeClass("i-preloader")},n.options.searchDelay)}function l(){function b(){for(var a=0;a<n.options.blockTitles.length;a++)g[a]=e(foodclubJSON[n.options.blockTitles[a]]),f(g[a],n.options.blockTitles[a]);n.loadImageTimeoutId=setTimeout(c,200)}function c(){n.$list.find("[data-image]").each(function(){var b=a(this);b.append('<img src="'+b.attr("data-image")+'" width="50" height="50" alt="" class="b-rs__item__image" onload="onloadRecipeSearchImage(this);">')})}function d(){g.join("")||(n.searchString=m(n.searchString),n.searchString=n.searchString.toLowerCase().split(" "),b())}function e(a){function b(a){for(var b=0;b<a.length;b++){var c=a[b].lowerTitle.indexOf(n.searchString[0]),d=a[b].title.substr(c,n.searchString[0].length);a[b].highlightedTitle=a[b].title.replace(d,"<b>"+d+"</b>")}}function c(a,b){a.index=1/0,b.index=1/0;for(var c=0;c<n.searchString.length;c++)a.index=Math.min(a.index,a.lowerTitle.indexOf(n.searchString[c])),b.index=Math.min(b.index,b.lowerTitle.indexOf(n.searchString[c]));return a.index<b.index&&-1!==a.index?-1:a.index>b.index&&-1!==b.index?1:-1===a.index?1:-1===b.index?-1:a.lowerTitle<b.lowerTitle?-1:a.lowerTitle>b.lowerTitle?1:0}function d(a){function b(c){var d=Math.ceil(c[0]+(c[1]-c[0])/2);return-1===a[d].index?d===c[1]?c[1]:b([c[0],d]):d===c[1]?c[1]+1:b([d,c[1]])}var c=b([0,a.length-1]);return a.slice(0,c)}var e;return a.items.sort(c),-1===a.items[0].index?e=[]:(e=d(a.items),b(e)),e}function f(b,c){function d(){var a="";b.length>n.options.itemsNum[c]&&(a='<span class="'+n.options.headingClass+'__num"><span class="'+n.options.headingClass+'__num__content">'+n.options.itemsNum[c]+" из "+b.length+"</span></span>"),n.$list.append('<li class="'+n.options.headingClass+'">'+a+window.foodclubJSON[c].title+"</li>")}function e(){for(var a=0;a<n.options.itemsNum[c];a++)if(b[a]){var d=window.foodclubJSON[c].url.replace("$&",b[a].id),e=f(b[a].time),h=g({url:d,image:b[a].image,title:b[a].highlightedTitle,time:e,nutrition:b[a].nutrition});n.$list.append(h)}}function f(a){var b={};return b.hours=Math.floor(a/60),b.minutes=a%60,b}function g(b){var c=document.getElementById("recipe_search_items").innerHTML,d=tmpl(c);return a(d(b))}0!==b.length&&(d(),e())}if(n.loadImageTimeoutId&&clearTimeout(n.loadImageTimeoutId),n.elemValue=n.$input.val(),n.$list.empty(),""===a.trim(n.elemValue))return void i();n.searchString=n.elemValue.toLowerCase().replace("ё","е").replace("й","и").split(" ");var g=[];return b(),d(),g.length?void n.$list.append('<li class="b-rs__search-all"><a href="/search/'+n.$input.val()+'/" class="b-rs__search-all__link">Все результаты</a></li>').show():void i()}function m(a){for(var b,c=0,d="";c<String(a).length;c++){b=String(a).substr(c,1);for(var e=0;e<o.length;e++)o[e][b]&&(d+=o[e][b])}return d}var n=this;c();var o=[{a:"�",b:"�",c:"�",d:"�",e:"�",f:"�",g:"�",h:"�",i:"�",j:"�",k:"�",l:"�",m:"�",n:"�",o:"�",p:"�",q:"�",r:"�",s:"�",t:"�",u:"�",v:"�",w:"�",x:"�",y:"�",z:"�"},{"а":"f","б":",","в":"d","г":"u","д":"l","е":"t","ё":"`","ж":";","з":"p","и":"b","й":"q","к":"r","л":"k","м":"v","н":"y","о":"j","п":"g","р":"h","с":"c","т":"n","у":"e","ф":"a","х":"[","ц":"w","ч":"x","ш":"i","щ":"o","ъ":"]","ы":"s","ь":"m","э":"'","ю":".","я":"z"}]}new b,a("[data-placeholder]").placeholder()})}(jQuery),function(a){var b={};a.fn.placeholder=function(c){var d=a.extend({},b,c);return a(this).each(function(){function b(){j.$placeholder||f(),c(),e()}function c(){setTimeout(function(){""===j.$elem.val()&&j.$formField.addClass("i-placeholder")},10)}function e(){j.$placeholderText.click(function(){j.$elem.focus()}),j.$elem.focus(function(){h()}).blur(function(){i()})}function f(){j.$placeholder=a('<div class="b-form-field__placeholder"><div class="b-form-field__placeholder__text">'+j.placeholderText+"</div></div>"),j.$placeholderText=j.$placeholder.find(".b-form-field__placeholder__text"),j.$elem.before(j.$placeholder),g()}function g(){function a(){j.$placeholderText.css({width:j.$elem.outerWidth()-parseInt(j.$placeholderText.css("paddingLeft"))+"px",height:j.$elem.outerHeight()-parseInt(j.$placeholderText.css("paddingTop"))+"px"})}if(j.$elem.is(":visible"))a();else{var b=j.$elem,c=b.parent();b.css({position:"absolute",bottom:"0",left:"0"}).appendTo("body"),a(),c.append(b),b.css({position:"static",bottom:"none",left:"none"})}}function h(){j.$formField.removeClass("i-placeholder")}function i(){""===j.$elem.val()&&j.$formField.addClass("i-placeholder")}var j=this;j.$elem=a(this),j.$formField=j.$elem.closest(".b-form-field"),j.placeholderText=d.text||j.$elem.attr("data-placeholder"),b()}),this}}(jQuery);